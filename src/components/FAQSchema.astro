---
export interface FAQItem {
  question: string;
  answer: string;
}

export interface Props {
  faqs: FAQItem[];
  location?: string;
}

const { faqs, location = "" } = Astro.props;

// Replace location variables in FAQ content
function replaceLocationVariables(text: string, locationName: string): string {
  return text
    .replace(/\[location\]/g, locationName)
    .replace(/\[Location\]/g, locationName.charAt(0).toUpperCase() + locationName.slice(1));
}

// Process FAQs with location variables
const processedFAQs = faqs.map(faq => ({
  question: replaceLocationVariables(faq.question, location),
  answer: replaceLocationVariables(faq.answer, location)
}));

// Generate FAQ schema
const faqSchema = {
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": processedFAQs.map(faq => ({
    "@type": "Question",
    "name": faq.question,
    "acceptedAnswer": {
      "@type": "Answer",
      "text": faq.answer
    }
  }))
};
---

<script type="application/ld+json" set:html={JSON.stringify(faqSchema)}></script>

<div class="faq-section">
  <h2 class="text-3xl font-bold mb-8">Frequently Asked Questions</h2>
  <div class="space-y-6">
    {processedFAQs.map((faq) => (
      <div class="bg-white rounded-lg shadow-md p-6">
        <h3 class="text-xl font-semibold text-blue-900 mb-3">{faq.question}</h3>
        <p class="text-gray-700">{faq.answer}</p>
      </div>
    ))}
  </div>
</div>

<style>
  .faq-section {
    margin: 3rem 0;
    padding: 2rem;
    background: #f8f9fa;
    border-radius: 0.5rem;
  }
</style>